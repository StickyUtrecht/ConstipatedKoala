- content_for(:page, 'checkout')
- content_for(:subpage, 'products')

- content_for(:title, 'Constipated koala | checkout | producten') 

%section#content
  = render 'layouts/search'

  .page.page-form{ :data => { 'authenticity_token' => form_authenticity_token}}
    .row
      .col-md-6.hidden-xs
        .panel.panel-default
          .panel-heading
            %i.fa.fa-fw.fa-ticket
            Producten
            
          %table.table.table-striped.table-linked#products
            %tbody
              - @products.each do |product|
                %tr{ :data => { 'id' => product.id }}
                  %td= link_to product.name, product.image.url(:original)
                  %td= I18n.t( product.category, scope: 'activerecord.attributes.checkout_product.categories' ).downcase
                  %td= number_to_currency( product.price, :unit => '€' )
                  %td.buttons
                    .btn-group
                      %button.btn.btn-default.destroy
                        %i.fa.fa-fw.fa-trash-o
                    

      = form_for :checkout_product, url: checkout_products_path, method: :post, :class => 'form-validation' do |f|   
        - if @product.errors.any?
          .col-md-6
            .alert.alert-danger
              %button.close{ type: "button" } ×
              %span Oeps, niet alles is goed ingevuld;
              %ul
              - @product.errors.full_messages.each do |msg|
                %li= msg
        
        .col-md-6
          .panel.panel-default
            .panel-heading
              %i.fa.fa-fw.fa-ticket
              Nieuw product
            .panel-body
            
              .form-group
                .row
                  .col-md-8              
                    = label(:checkout_product, :name)
                    = f.text_field :name, :value => @product.name, :class => 'form-control'
                  .col-md-4
                    = label(:checkout_product, :price)
                    = f.text_field :price, :value => number_to_currency(@product.price, :unit => ''), :class => 'form-control'
                
              .form-group
                .row
                  .col-md-4
                    = label(:checkout_product, :category)
                    .ui-select
                      = f.select :category, options_for_select( CheckoutProduct.categories.map{ |name, id| [I18n.t(name, scope: 'activerecord.attributes.checkout_product.categories'), name] }, @product.category )
                  .col-md-8
                    = label(:checkout_product, :image)
                    .input-group
                      %input#output.form-control{ :readonly => ''}
  
                      .input-group-btn
                        %button.btn.btn-primary.file-input-wrapper
                          %span uploaden
                          = f.file_field :image, { 'data-ui-file-upload' => '' }    

              %button.btn.btn-success.wait{type: 'submit'} Opslaan
              = link_to 'Annuleren', checkout_products_path, { :class => 'button btn btn-default' }