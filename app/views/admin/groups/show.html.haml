- content_for(:page, 'groups')
- content_for(:title, 'Groepen')

%section#content
  = render 'layouts/partials/search'

  .page.page-form{ :data => { 'authenticity_token' => form_authenticity_token} }
    .row
      .col-md-6
        = form_for :group, :url => group_path(@group), :method => :patch, :class => 'form-validation' do |f|
          - if @group.errors.any?
            .alert.alert-danger
              %button.close{ type: "button" } Ã—
              %span Oeps, niet alles is goed ingevuld;
              %ul
              - @group.errors.full_messages.each do |msg|
                %li= msg
          .panel.panel-default
            .panel-heading
              %i.fa.fa-fw.fa-users
              - if @group.category.nil?
                Nieuwe groep
              - else
                Bewerk
                = I18n.t(@group.category, scope: 'activerecord.attributes.group.categories')
            .panel-body

              .form-group
                .row
                  .col-md-12
                    = f.label I18n.t( :name, scope: 'activerecord.attributes.group' )
                    = f.text_field :name, :value => @group.name, :class => 'form-control'

                .form-group
                  = label(:group, I18n.t( :comments, scope: 'activerecord.attributes.group' ))
                  = f.text_area :comments, :value => @group.comments, :class => 'form-control', :rows => 5

              %button.btn.btn-success.wait{ type: 'submit' } Opslaan
              = link_to 'Annuleren', groups_path, { :class => 'button btn btn-default' }

              = link_to 'nieuw jaar?', '#', { :class => 'button btn btn-warning' }

              - if @group.category != "board"
                = link_to "Verwijderen", @group, { :class => 'button btn btn-danger pull-right', 'data-method' => :delete }


        .panel.panel-default.table-dynamic

          .panel-heading.year
            %i.fa.fa-fw.fa-fw.fa-users
            Geschiedenis

          %table.table.table-striped.table-linked
            %tbody
              - @group.history.each do |group|
                - if group != @group
                  %tr
                    %td= link_to "#{group.name}", group
                    %td= group.year.to_study_year
                    %td.hidden-sm= group.members.map{ |member| member.name }.join(', ')


      .col-md-6
        .panel.panel-default
          .panel-heading.year
            %i.fa.fa-fw.fa-user
            = I18n.t(@group.category, scope: 'activerecord.attributes.group.members')

          %template#group_member
            = render 'admin/groups/partials/member', member: Member.new, group: @group
          %table.table.table-striped.table-linked#members{ :data => { :id => @group.id} }

            - @group.members.each do |member|
              = render 'admin/groups/partials/member', member: member, group: @group

            %tr
              %td{ :colspan => 3, :style => 'position: relative;'}
                %input#member{ :tabindex => '-1', :autocomplete => 'off' }
                %ul.dropdown-menu
